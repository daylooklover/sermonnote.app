<!DOCTYPE html>
<html lang="ko">
<head>
Â  <meta charset="UTF-8" />
Â  <title>ì„¤êµ ì‘ì„± - í€µë©”ëª¨ + AI</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
Â  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
Â  <style>
Â  Â  body {
Â  Â  Â  margin: 0;
Â  Â  Â  font-family: 'Nanum Gothic', sans-serif;
Â  Â  Â  background: var(--bg, #f9f9f9);
Â  Â  Â  color: var(--text, #222);
Â  Â  Â  display: flex;
Â  Â  Â  height: 100vh;
Â  Â  }

Â  Â  .left-panel {
Â  Â  Â  width: 300px;
Â  Â  Â  background: var(--side, #e0e0e0);
Â  Â  Â  padding: 20px;
Â  Â  Â  overflow-y: auto;
Â  Â  }

Â  Â  .left-panel h2 {
Â  Â  Â  font-size: 18px;
Â  Â  Â  color: #1976d2;
Â  Â  Â  margin-bottom: 10px;
Â  Â  }

Â  Â  .memo-item {
Â  Â  Â  background: #fff;
Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  padding: 10px;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background 0.2s;
Â  Â  Â  border: 1px solid #ccc;
Â  Â  }

Â  Â  .memo-item:hover {
Â  Â  Â  background: #f0f0f0;
Â  Â  }

Â  Â  .right-panel {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 30px;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  }

Â  Â  textarea {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 20px;
Â  Â  Â  font-size: 16px;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  background: #fff;
Â  Â  Â  color: #000;
Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  resize: vertical;
Â  Â  Â  min-height: 200px;
Â  Â  Â  box-shadow: inset 0 0 5px #bbb;
Â  Â  }

Â  Â  .button-bar {
Â  Â  Â  margin-top: 15px;
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 10px;
Â  Â  Â  justify-content: flex-start;
Â  Â  }

Â  Â  button {
Â  Â  Â  padding: 10px 16px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  font-weight: bold;
Â  Â  Â  cursor: pointer;
Â  Â  Â  background-color: #1976d2;
Â  Â  Â  color: white;
Â  Â  }

Â  Â  button:hover {
Â  Â  Â  background-color: #0d47a1;
Â  Â  }

Â  Â  #resultBox {
Â  Â  Â  margin-top: 20px;
Â  Â  Â  padding: 15px;
Â  Â  Â  background: #e3f2fd;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  white-space: pre-line;
Â  Â  Â  color: #000;
Â  Â  Â  resize: vertical;
Â  Â  Â  min-height: 100px;
Â  Â  Â  overflow-y: auto;
Â  Â  }

Â  Â  .top-bar {
Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  text-align: right;
Â  Â  }

Â  Â  .top-bar button {
Â  Â  Â  background: #555;
Â  Â  Â  margin-left: 10px;
Â  Â  }

Â  Â  .top-bar button.light {
Â  Â  Â  background: #eee;
Â  Â  Â  color: #000;
Â  Â  }

    /* ì¶”ê°€ëœ ìŠ¤íƒ€ì¼: ì›ì–´/ì£¼ì„ íŒì—… */
    #wordInfoPopup {
        position: absolute;
        background: #333;
        color: white;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
        max-width: 300px;
        text-align: left;
        line-height: 1.4;
    }
    #wordInfoPopup p {
        margin: 0 0 5px 0;
    }
    #wordInfoPopup strong {
        color: #FFD700; /* í™©ê¸ˆìƒ‰ ê°•ì¡° */
    }
    #wordInfoPopup .original-text {
        font-family: 'Times New Roman', serif; /* ì›ì–´ í°íŠ¸ */
        font-size: 1.1em;
        font-weight: bold;
        margin-bottom: 5px;
    }
    #wordInfoPopup .original-language {
        font-size: 0.9em;
        color: #ccc;
    }
Â  </style>
</head>
<body>

Â  <div class="left-panel">
Â  Â  <h2>ğŸ“ í€µë©”ëª¨</h2>
Â  Â  <div id="memoList"></div>
Â  </div>

Â  <div class="right-panel">
Â  Â  <div class="top-bar">
Â  Â  Â  <button onclick="toggleTheme()">ğŸŒ™ í…Œë§ˆ ë³€ê²½</button>
Â  Â  </div>
Â  Â  <h1>ğŸ“– ì„¤êµë¬¸ ì‘ì„±</h1>
Â  Â  <textarea id="sermonText" placeholder="ì„¤êµë¬¸ì„ ì‘ì„±í•˜ê±°ë‚˜ í€µë©”ëª¨ë¥¼ ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."></textarea>

Â  Â  <div class="button-bar">
Â  Â  Â  <button onclick="saveToFirebase()">ğŸ’¾ ì €ì¥</button>
Â  Â  Â  <button onclick="generateOutline()">âœ ê°œìš” ìƒì„±</button>
Â  Â  Â  <button onclick="recommendBible()">ğŸ“– ì„±ê²½ ì¶”ì²œ</button>
Â  Â  Â  <button onclick="fixGrammar()">ğŸª„ ë¬¸ë²• ìˆ˜ì •</button>
Â  Â  Â  <button onclick="startVoice()">ğŸ¤ ìŒì„±ì…ë ¥</button>
Â  Â  Â  <button onclick="print()">ğŸ–¨ï¸ ì¸ì‡„</button>
Â  Â  </div>

Â  Â  <div id="resultBox">ğŸ’¡ AI ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
Â  </div>

    <div id="wordInfoPopup"></div>

Â  <script>
Â  Â  // í…Œë§ˆ ì „í™˜
Â  Â  function toggleTheme() {
Â  Â  Â  const isDark = document.body.style.getPropertyValue('--bg') === '#1c1c2b';
Â  Â  Â  if (isDark) {
Â  Â  Â  Â  document.body.style.setProperty('--bg', '#f9f9f9');
Â  Â  Â  Â  document.body.style.setProperty('--text', '#222');
Â  Â  Â  Â  document.body.style.setProperty('--side', '#e0e0e0');
Â  Â  Â  } else {
Â  Â  Â  Â  document.body.style.setProperty('--bg', '#1c1c2b');
Â  Â  Â  Â  document.body.style.setProperty('--text', '#eee');
Â  Â  Â  Â  document.body.style.setProperty('--side', '#2c2c3b');
Â  Â  Â  }
Â  Â  }

Â  Â  // í€µë©”ëª¨ ë¶ˆëŸ¬ì˜¤ê¸°
Â  Â  const quickmemos = JSON.parse(localStorage.getItem("quickmemos")) || [
Â  Â  Â  "í•˜ë‚˜ë‹˜ì˜ ì€í˜œëŠ” ë¬´í•œí•©ë‹ˆë‹¤.",
Â  Â  Â  "ë¯¿ìŒì€ ì‹œë ¨ì„ ê²¬ë””ê²Œ í•©ë‹ˆë‹¤.",
Â  Â  Â  "ì‚¬ë‘ì€ ëª¨ë“  ê²ƒì„ ì´ê¹ë‹ˆë‹¤."
Â  Â  ];

Â  Â  const memoListEl = document.getElementById("memoList");
Â  Â  const sermonText = document.getElementById("sermonText");

Â  Â  function renderMemos() {
Â  Â  Â  memoListEl.innerHTML = "";
Â  Â  Â  quickmemos.forEach((memo) => {
Â  Â  Â  Â  const div = document.createElement("div");
Â  Â  Â  Â  div.className = "memo-item";
Â  Â  Â  Â  div.textContent = memo;
Â  Â  Â  Â  div.onclick = () => {
Â  Â  Â  Â  Â  sermonText.value += (sermonText.value ? "\n" : "") + memo;
Â  Â  Â  Â  };
Â  Â  Â  Â  memoListEl.appendChild(div);
Â  Â  Â  });
Â  Â  }

Â  Â  // ìŒì„± ì¸ì‹
Â  Â  function startVoice() {
Â  Â  Â  const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
Â  Â  Â  recognition.lang = 'ko-KR';
Â  Â  Â  recognition.start();
Â  Â  Â  recognition.onresult = function(event) {
Â  Â  Â  Â  const transcript = event.results[0][0].transcript;
Â  Â  Â  Â  sermonText.value += "\n" + transcript;
Â  Â  Â  };
Â  Â  Â  recognition.onerror = function(event) {
Â  Â  Â  Â  alert("ìŒì„± ì¸ì‹ ì˜¤ë¥˜: " + event.error);
Â  Â  Â  };
Â  Â  }

Â  Â  // Firebase ì´ˆê¸°í™”
Â  Â  const firebaseConfig = {
Â  Â  Â  apiKey: "AIzaSyB1YVJr-aPDADp-SgYtA9X2XagYoTTJn4M",
Â  Â  Â  authDomain: "sermonnote-live.firebaseapp.com",
Â  Â  Â  projectId: "sermonnote-live",
Â  Â  };
Â  Â  firebase.initializeApp(firebaseConfig);
Â  Â  const db = firebase.firestore();

Â  Â  function saveToFirebase() {
Â  Â  Â  const content = sermonText.value.trim();
Â  Â  Â  if (!content) return alert("ì„¤êµë¬¸ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.");
Â  Â  Â  db.collection("sermons").add({
Â  Â  Â  Â  content,
Â  Â  Â  Â  timestamp: new Date()
Â  Â  Â  }).then(() => alert("âœ… ì„¤êµ ì €ì¥ ì™„ë£Œ!"));
Â  Â  }

Â  Â  async function callAI(prompt) {
Â  Â  Â  const res = await fetch("https://us-central1-sermonnote-live.cloudfunctions.net/ai", {
Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  body: JSON.stringify({ prompt })
Â  Â  Â  });
Â  Â  Â  const data = await res.json();
Â  Â  Â  return data.result || "âš ï¸ AI ì‘ë‹µ ì˜¤ë¥˜";
Â  Â  }

Â  Â  async function generateOutline() {
Â  Â  Â  const text = sermonText.value;
Â  Â  Â  const result = await callAI(`"${text}"ì— ëŒ€í•œ ì„¤êµ ê°œìš”ë¥¼ ì‘ì„±í•´ì¤˜. ì„œë¡ , ë³¸ë¡ , ê²°ë¡  í¬í•¨.`);
Â  Â  Â  document.getElementById("resultBox").innerText = result;
Â  Â  }

Â  Â  async function recommendBible() {
Â  Â  Â  const text = sermonText.value;
Â  Â  Â  const result = await callAI(`"${text}"ì™€ ê´€ë ¨ëœ ì„±ê²½ êµ¬ì ˆ 3ê°œë¥¼ ì¶”ì²œí•´ì¤˜ (ì„¤ëª… í¬í•¨).`);
Â  Â  Â  document.getElementById("resultBox").innerText = result;
Â  Â  }

Â  Â  async function fixGrammar() {
Â  Â  Â  const text = sermonText.value;
Â  Â  Â  const result = await callAI(`ë‹¤ìŒ ì„¤êµë¬¸ì˜ ë¬¸ì¥ì„ ë‹¤ë“¬ì–´ì¤˜:\n${text}`);
Â  Â  Â  document.getElementById("resultBox").innerText = result;
Â  Â  }

Â  Â  renderMemos();

    // ìƒˆë¡­ê²Œ ì¶”ê°€ëœ JavaScript ì½”ë“œ: ì›ì–´/ì£¼ì„ íŒì—… ê¸°ëŠ¥
    const wordInfoPopup = document.getElementById("wordInfoPopup");

    sermonText.addEventListener('mouseup', function(event) {
        // í…ìŠ¤íŠ¸ ì„ íƒ(ë“œë˜ê·¸)ì´ ëë‚¬ì„ ë•Œ
        const selectedText = window.getSelection().toString().trim();

        if (selectedText.length > 0) { // ì„ íƒëœ í…ìŠ¤íŠ¸ê°€ ìˆì„ ê²½ìš°
            // ì˜ˆì‹œ ë°ì´í„° (ì‹¤ì œë¡œëŠ” ë°±ì—”ë“œ APIì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨)
            const exampleData = {
                "ì‚¬ë‘ì€": {
                    original: "á¼€Î³Î¬Ï€Î· (agapÄ“)",
                    language: "ê·¸ë¦¬ìŠ¤ì–´",
                    meaning: "í•˜ë‚˜ë‹˜ì˜ ì¡°ê±´ ì—†ëŠ” ì‚¬ë‘, ì´íƒ€ì ì¸ ì‚¬ë‘ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ë‹¨ìˆœíˆ ê°ì •ì ì¸ ì‚¬ë‘ì„ ë„˜ì–´ì„  ì˜ì§€ì ì´ê³  í¬ìƒì ì¸ ì‚¬ë‘ì…ë‹ˆë‹¤."
                },
                "í•˜ë‚˜ë‹˜": {
                    original: "Î¸ÎµÏŒÏ‚ (theos)",
                    language: "ê·¸ë¦¬ìŠ¤ì–´",
                    meaning: "ëª¨ë“  ê²ƒì„ ì°½ì¡°í•˜ê³  ë‹¤ìŠ¤ë¦¬ëŠ” ì‹ . êµ¬ì•½ì˜ 'ì—˜ë¡œí˜' ë˜ëŠ” 'ì•¼í›¼'ì— í•´ë‹¹í•©ë‹ˆë‹¤."
                },
                "ì„¸ìƒì„": {
                    original: "ÎºÏŒÏƒÎ¼Î¿Ï‚ (kosmos)",
                    language: "ê·¸ë¦¬ìŠ¤ì–´",
                    meaning: "ìš°ì£¼ ì „ì²´, ì§ˆì„œ ì •ì—°í•œ ì„¸ê³„, ë˜ëŠ” íƒ€ë½í•œ ì¸ë¥˜ ì‚¬íšŒë¥¼ ì˜ë¯¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬¸ë§¥ì— ë”°ë¼ í•´ì„ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤."
                },
                "ì˜ˆìˆ˜": {
                    original: "á¼¸Î·ÏƒÎ¿á¿¦Ï‚ (IÄ“sous)",
                    language: "ê·¸ë¦¬ìŠ¤ì–´",
                    meaning: "í•˜ë‚˜ë‹˜ì˜ ì•„ë“¤ì´ì‹œë©° êµ¬ì›ìì´ì‹  ì˜ˆìˆ˜ ê·¸ë¦¬ìŠ¤ë„ì˜ ì´ë¦„ì…ë‹ˆë‹¤. 'ì—¬í˜¸ì™€ëŠ” êµ¬ì›ì´ì‹œë‹¤'ë¼ëŠ” ì˜ë¯¸ë¥¼ ê°€ì§‘ë‹ˆë‹¤."
                },
                // ë” ë§ì€ ë‹¨ì–´ì— ëŒ€í•œ ë°ì´í„° ì¶”ê°€ ê°€ëŠ¥
            };

            const info = exampleData[selectedText]; // ì„ íƒëœ í…ìŠ¤íŠ¸ì— í•´ë‹¹í•˜ëŠ” ì •ë³´ ì°¾ê¸°

            if (info) {
                // íŒì—… ë‚´ìš© ì„¤ì •
                wordInfoPopup.innerHTML = `
                    <p><strong>ì„ íƒëœ ë‹¨ì–´:</strong> ${selectedText}</p>
                    <p class="original-text">${info.original} <span class="original-language">(${info.language})</span></p>
                    <p><strong>ì˜ë¯¸/ì£¼ì„:</strong> ${info.meaning}</p>
                `;

                // íŒì—… ìœ„ì¹˜ ì„¤ì • (ë§ˆìš°ìŠ¤ ì»¤ì„œ ê·¼ì²˜)
                wordInfoPopup.style.left = `${event.pageX + 10}px`;
                wordInfoPopup.style.top = `${event.pageY + 10}px`;
                wordInfoPopup.style.display = 'block'; // íŒì—… ë³´ì´ê¸°
            } else {
                // í•´ë‹¹ ë‹¨ì–´ ì •ë³´ê°€ ì—†ì„ ê²½ìš° íŒì—… ìˆ¨ê¹€
                wordInfoPopup.style.display = 'none';
            }
        } else {
            // í…ìŠ¤íŠ¸ ì„ íƒì´ ì—†ì„ ê²½ìš° íŒì—… ìˆ¨ê¹€
            wordInfoPopup.style.display = 'none';
        }
    });

    // ì•„ë¬´ ê³³ì´ë‚˜ í´ë¦­í•˜ë©´ íŒì—… ìˆ¨ê¸°ê¸°
    document.addEventListener('mousedown', function(event) {
        if (!wordInfoPopup.contains(event.target) && event.target !== sermonText) {
            wordInfoPopup.style.display = 'none';
        }
    });

    // í…ìŠ¤íŠ¸ ì˜ì—­ ë°–ì„ í´ë¦­í•´ë„ íŒì—… ìˆ¨ê¸°ê¸°
    sermonText.addEventListener('blur', function() {
        wordInfoPopup.style.display = 'none';
    });

Â  </script>
</body>
</html>